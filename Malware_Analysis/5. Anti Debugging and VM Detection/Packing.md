Packing is a means of distributing executable in a packed state, meaning the code is not executable apart from the unpacking instruction that will unpack it in runtime.

In the context of malware, security products that perform automated static analysis may have issues flagging the binary as malicious. Packing in the context of malware is usually referred to as an obfuscation technique.

## Packers

### UPX

Ultimate Packer for Executables (UPX) is a free, portable, high performance executable packer. It archives the executable provided with an excellent compression ratio, and offers very fast decompression.

It is usually used to evade malware detection by compressing the executable to avoid pattern and behavioral analysis. UPX has its own unique signature in any executable packed by it.

### Themida Packer

Themida is a special packer that uses complex virtual machine environment combined with every anti-debug and many obfuscation methods.

The protected code is translated to virtual machine, which translates back to ordinary x86 code when the code is running. Until this day there is no ordinary way to bypass this method.

## Manual Packing

Manual packing is performed on the assembly code itself, essentially changing the current code using assembly instructions then, changing the logic of the executable to "decode" itself before execution, by adding assembly instructions to the program in order to revert the code back to its original state and execute properly.

This is a way to prevent signature recognition by scanners and programs.

### Packer Entry Point

First the program should be loaded into the debugger in order to choose the correct memory address to add the packer to. Following this address, there should be a pattern of at least 30bit of 00DB.

### Entry Point Modification

The modification will take place using the LordPE with setting the packer's address to be the entry point of the executable, and will be verified by running the program in the debugger.

The address for the new entry point is the packer's address minus the ImageBase because it is added automatically.

### Saving the Modified Executable

The code needs to be executed in order to let the packer encode the chosen range of instructions with XOR 0x70.

For this: Right click the code view window -> Copy to executable -> All modifications -> Copy all.

To save the code in the file window that opened: Right click -> Save file.