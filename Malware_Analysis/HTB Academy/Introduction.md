## Malware Objective Categories

- Disrupting host system operations
- Stealing critical information, including personal and financial data
- Gaining unauthorized access to systems
- Conducting espionage activities
- Sending spam messages
- Utilizing the victim's system for Distributed Denial of Service (DDoS) attacks
- Implementing ransomware to lock up victim's files on their host and demanding ransom

## Malware Types

- **Viruses:** Designed to infiltrate and multiply within host files, transitioning from one system to another. They latch into legitimate programs, and take effect when the infected files are triggered. It can even spread through network.
- **Worms:** Worms can multiply across network devices without human interaction, they exploit network weaknesses to infiltrate systems without permission. They can deliver damaging payloads, or keep multiplying to other vulnerable devices.
- **Trojans:** Disguised as regular software to trick users into running them. Upon entering the system, they craft backdoors, allowing attackers to control the system. They can be weaponized to pilfer sensitive data, such as passwords or financial information, and orchestrate other harmful activities on the infected host.
- **Ransomware:** It encrypts files on the target system, making them unreachable. Attackers then demand a ransom in exchange for the decryption key.
- **Spyware:** This malware stealthily gathers sensitive data or user activities without their consent. It can track online browsing habits, record keystrokes, and capture login credentials.
- **Adware:** It shows uninvited and invasive advertisements on infected systems. They may also collect user data for targeted advertising.
- **Botnets:** Stealthy form of malware, designed to take control over the fundamental components (the "root") of an operating system. They alter system functions to conceal their presence, making them extremely challenging to spot and eliminate. They can be used to prolong access and evade security protocols.
- **Backdoors/RATs (Remote Access Trojans):** Those are crafted to provide unauthorized access and control over compromised systems from remote locations.
- **Droppers:** Used to transport and install extra malicious software into infected system. They serve as a conduit for other malware, ensuring the covert installation and execution of more sophisticated threats.
- **Information Stealers:** Tailored to target and extract sensitive data. Like login credentials, personal information, or intellectual property. This includes identity theft or selling the data on the dark web.

Those examples are just some of the types of malware.

## Malware Samples Resources

- [VirusShare](https://virusshare.com/): Houses a vast collection of malware samples. they currently have over 30 million samples in their repository, all free.
- [Hybrid Analysis](https://www.hybrid-analysis.com/): This website allows to submit files for malware analysis. However, they also have a public feed of their analyses, where malware samples are often shared.
- [TheZoo](https://github.com/ytisf/theZoo): A GitHub repository that contains a collection of live malware for analysis and education. The repository also contains additional information about each sample, such as its family and the type of activities it performs.
- [Malware-Traffic-Analysis.net](https://malware-traffic-analysis.net/): This website provides traffic analysis exercises that can be extremely beneficial for people trying to learn about malware traffic patterns. They often provide pcap files of actual malware traffic, which can be quite informative.
- [VirusTotal](https://www.virustotal.com): VirusTotal inspects items with over 70 antivirus scanners and URL/domain blocklisting services, in addition to a myriad of tools to extract signals from the studied content. Any user can select a file from their computer using their browser and send it to VirusTotal. VirusTotal offers a number of file submission methods, including the primary public web interface, desktop uploaders, browser extensions and a programmatic API.
- [ANY.RUN](https://app.any.run/): An interactive online sandbox for malware analysis. The service allows researchers to analyze malware behavior by running samples in a controlled environment. While it offers both free and paid tiers, even the free version provides access to public submissions, which can include various malware samples.
- [Contagio Malware Dump](https://contagiodump.blogspot.com/): Contagio Dump is a collection of malware samples, threat reports, and related resources curated by a malware researcher named Mila. The site provides direct, anonymized access to an extensive range of malware samples, including various types of trojans, worms, ransomware, and exploits. It's frequently used by security researchers and analysts to study malware behavior and develop mitigation techniques.
- [VX Underground](https://www.vx-underground.org/): VX-Underground is one of the largest collections of malware source code, articles, and papers on the internet. It aims to collect, preserve, and share all kinds of materials related to malware, exploit, and hacking culture. This resource is valuable to security researchers and enthusiasts who want to study malware construction and behavior from a more technical and code-centric perspective.

## Malware/Evidence Acquisition

### Disk Imaging Solutions

- [FTK Imager](https://www.exterro.com/ftk-imager): Developed by AccessData (now acquired by Exterro), FTK Imager is one of the most widely used disk imaging tools in the cybersecurity field. It allows us to create perfect copies (or images) of computer disks for analysis, preserving the integrity of the evidence. It also lets us view and analyze the contents of data storage devices without altering the data.
- [OSFClone](https://www.osforensics.com/tools/create-disk-images.html): A free, open-source utility designed for the task of creating and cloning forensic disk images. It's easy to use and supports a wide variety of file systems.
- `DD and DCFLDD`: Both are command-line utilities available on Unix-based systems (including Linux and MacOS). DD is a versatile tool included in most Unix-based systems by default, while DCFLDD is an enhanced version of DD with features specifically useful for forensics, such as hashing.

### Memory Acquisition Solutions

- [DumpIt](https://www.magnetforensics.com/resources/magnet-dumpit-for-windows/): A simplistic utility that generates a physical memory dump of Windows and Linux machines. On Windows, it concatenates 32-bit and 64-bit system physical memory into a single output file, making it extremely easy to use.
- [MemDump](http://www.nirsoft.net/utils/nircmd.html): MemDump is a free, straightforward command-line utility that enables us to capture the contents of a system's RAM. Itâ€™s quite beneficial in forensics investigations or when analyzing a system for malicious activity. Its simplicity and ease of use make it a popular choice for memory acquisition.
- [Belkasoft RAM Capturer](https://belkasoft.com/ram-capturer): This is another powerful tool we can use for memory acquisition, provided free of charge by Belkasoft. It can capture the RAM of a running Windows computer, even if there's active anti-debugging or anti-dumping protection. This makes it a highly effective tool for extracting as much data as possible during a live forensics investigation.
- [Magnet RAM Capture](https://www.magnetforensics.com/resources/magnet-ram-capture/): Developed by Magnet Forensics, this tool provides a free and simple way to capture the volatile memory of a system.
- [LiME (Linux Memory Extractor)](https://github.com/504ensicsLabs/LiME): LiME is a Loadable Kernel Module (LKM) which allows the acquisition of volatile memory. LiME is unique in that it's designed to be transparent to the target system, evading many common anti-forensic measures.

### Other Evidence Acquisition Solutions

- [KAPE (Kroll Artifact Parser and Extractor)](https://www.kroll.com/en/services/cyber-risk/incident-response-litigation-support/kroll-artifact-parser-extractor-kape): KAPE is a triage program designed to help in collecting and parsing artifacts in a quick and effective manner. It focuses on targeted collection, reducing the volume of collected data and the time required for analysis. KAPE is free for use and is an essential tool in our digital forensics toolkit.
- [Velociraptor](https://github.com/Velocidex/velociraptor): Velociraptor is a versatile tool designed for host-based incident response and digital forensics. It allows for quick, targeted data collection across a wide number of machines. Velociraptor employs Velocidex Query Language (VQL), a powerful tool to collect and manipulate artifacts. The open-source nature of Velociraptor makes it a valuable free tool in our arsenal.

## Malware Analysis Definition, Purpose, and Common Activities

Malware analysis is done to comprehend the inner workings of malware. It aids in understanding the threat posed by malicious software and devising effective countermeasures.

We will delve into the malware code, structure, and functionality to gain profound insights into its purpose, propagation methods, and potential impact on targeted systems. By answering pertinent questions, such as the type of malware, its intended behavior on endpoints, the aftermath of its execution, the extent of damage it can inflict, its attribution to specific thread groups, and creating detection rules based on the analysis to detect the malware across the entire network, we can devise robust defense mechanisms against these threads.

Malware analysis serves several pivotal purposes, such as:

- **Detection and Classification:** Through analyzing malware, we can identify and categorize different types of threats based on their unique characteristics, signatures, or patterns. This enables us to develop detection rules and empowers security professionals to gain a comprehensive understanding of the nature of the malware they encounter.
- **Reverse Engineering:** Malware analysis often involves the intricate process of reverse engineering the malware's code to discern its underlying operations and employed techniques. This can unveil concealed functionalities, encryption methods, details about the command-and-control infrastructure, and techniques used for obfuscation and evasion.
- **Behavioral Analysis:** By meticulously studying the behavior of malware during execution, we gain insights into its actions, such as modifications to the file system, network communications, changes to the system registry, and attempts to exploit vulnerabilities. This analysis provides invaluable information about the impact of the malware on infected systems and assists in devising potential countermeasures.
- **Threat Intelligence:** Through malware analysis, threat researchers can amass critical intelligence about attackers, their tactics, techniques, and procedures (TTPs), and the malware's origins. This valuable intelligence can be shared with the wider security community to enhance detection, prevention, and response capabilities.

The `techniques` employed in malware analysis encompass a wide array of methods and tools, including:

- **Static Analysis:** This approach involves scrutinizing the malware's code without executing it, examining the file structure, identifying strings, searching for known signatures, and studying metadata to gain preliminary insights into the malware's characteristics.
- **Dynamic Analysis:** Dynamic analysis entails executing the malware within a controlled environment, such as a sandbox or virtual machine, to observe its behavior and capture its runtime activities. This includes monitoring network traffic, system calls, file system modifications, and other interactions.
- **Code Analysis:** Code analysis (includes reverse engineering) and involves disassembling or decompiling the malware's code to understand its logic, functions, algorithms, and employed techniques. This helps in identifying concealed functionalities, exploitation methods, encryption methods, details about the command-and-control infrastructure, and techniques used for obfuscation and evasion. Î™nferentially, code analysis can also help in uncovering potential Indicators of Compromise (IOCs).
- **Memory Analysis:** Analyzing the malware's interactions with system memory helps in identifying injected code, hooks, or other runtime manipulations. This can be instrumental in detecting rootkits, analyzing anti-analysis techniques, or identifying malicious payloads.
- **Malware Unpacking:** This technique refers to the process of extracting and isolating the hidden malicious code within a piece of malware that uses packing techniques to evade detection. Packers are used by malware authors to compress, encrypt, or obfuscate their malicious code, making it harder for antivirus software and other security tools to identify the threat. Unpacking involves reverse-engineering these packing techniques to reveal the original, unobfuscated code for further analysis. This can allow researchers to understand the malware's functionality, behavior, and potential impact.