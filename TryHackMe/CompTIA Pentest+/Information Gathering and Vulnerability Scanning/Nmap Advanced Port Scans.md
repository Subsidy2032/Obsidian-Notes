#Nmap 

## TCP Null, FIN and Xmas Scan

No response if the port is open, RST if it's closed, useful in case of stateless firewall which only check for packets with the SYN flag set.

`-sN` - Null scan, no flags are set.
`-sF` - Fin scan, FIN flag is set.
`-sX` - Xmas scan, FIN, PSH and URG flags are set.

## TCP Maimon Scan

Won't work on most system, since you'll get a RST response whether the port is open or closed.

`-sM` - FIN and ACK flags are set.

## TCP ACK Scan

Useful for checking which ports aren't blocked by a firewall, will always return RST whether the port is open or closed.

`-sA` - ACK flag is set.

## TCP Window Scan

Similar to TCP ACK scan, but checking the window field to get more insight on ports not filtered by the firewall.

`-sW` - ACK flag is set.
	
	
`--scanflags RSTSYNFIN` - Example of custom scan.

## Spoofing

`nmap -e NET_INTERFACE -Pn -S SPOOFED_IP 10.10.41.196` - Spoof IP address and specify interface, only beneficial if you can capture the traffic.

`--spoof-mac SPOOFED_MAC` - Spoof the mac address, only works when the attacker and target machine are on the same subnet.

`nmap -D 10.10.0.1,10.10.0.2,RND,RND,ME 10.10.41.196` - Decoy IPs so the scan will appear to come from different sources.

## Fragmented Packets

`-f` - Fragment your packet to 8 byte size packets, 16 bytes if using `-ff`.

`--mtu` - Change the default fragmentation value, should be a multiple of 8.

`--data-length NUM` - Append bytes to your packets so they will appear innocuous.

## Idle/Zombie Scan

1. Trigger an idle host to response with an RST packet incrementing his IP ID by 1.
2. Send a SYN packet to a TCP port on the target using the idle host's IP address, he will increase the IP ID by one after sending an RST packet if he gets a response.
3. Send a SYN ACK packet to the idle host again like in step 1, if the value of the IP ID is incremented by 2 and not 1 the port is open.

`nmap -sI ZOMBIE_IP 10.10.41.196` - Idle scan.
	
	

`--source-port PORT_NUM` - Specify source port number.

`--reason` - Get Nmap to provide more reasoning.

`-v/-vv` - Verbose mode.

`-d/-dd` - For debugging details, will exceed a single screen.